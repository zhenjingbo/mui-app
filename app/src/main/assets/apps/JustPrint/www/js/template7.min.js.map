{"version":3,"sources":["template7.js"],"names":["window","Template7","isArray","arr","Object","prototype","toString","apply","isFunction","func","helperToSlices","string","shiftIndex","i","j","helperParts","replace","split","slices","length","part","push","indexOf","match","hashParts","hashName","hashContent","hash","stringToBlocks","blocks","_blocks","block","type","content","contextName","helperSlices","helperName","isPartial","helperContext","helperHash","slice","helperContent","elseContent","toSkip","foundClosed","foundElse","depth","inverseContent","template","getCompileFn","compile","getCompileInverse","getCompileVar","name","ctx","variable","parts","levelsUp","newDepth","isFinite","getCompiledArguments","contextArray","join","t","Error","resultString","compiledArguments","helpers","JSON","stringify","eval","call","this","compiled","options","partials","_partial","partialName","p","t7","data","root","escape","context","if","fn","inverse","unless","each","ret","reverse","first","last","index","key","with","delimiter","delimeter","js","expression","js_compare","condition","arguments","instance","rendered","registerHelper","unregisterHelper","undefined","registerPartial","unregisterPartial"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AAAAA,OAAOC,UAAY,WACf,YACA,SAASC,GAAQC,GACb,MAAgD,mBAAzCC,OAAOC,UAAUC,SAASC,MAAMJ,GAK3C,QAASK,GAAWC,GAChB,MAAuB,kBAATA,GAGlB,QAASC,GAAeC,GACpB,GAEIC,GAAYC,EAAGC,EAFfC,EAAcJ,EAAOK,QAAQ,UAAW,IAAIC,MAAM,KAClDC,IAEJ,KAAKL,EAAI,EAAGA,EAAIE,EAAYI,OAAQN,IAAK,CACrC,GAAIO,GAAOL,EAAYF,EACvB,IAAU,IAANA,EAASK,EAAOG,KAAKD,OAErB,IAA0B,IAAtBA,EAAKE,QAAQ,KAEb,GAAgC,IAA5BF,EAAKG,MAAM,MAAMJ,OAEjBD,EAAOG,KAAKD,OAEX,CAGD,IADAR,EAAa,EACRE,EAAID,EAAI,EAAGC,EAAIC,EAAYI,OAAQL,IAEpC,GADAM,GAAQ,IAAML,EAAYD,GACtBC,EAAYD,GAAGQ,QAAQ,MAAQ,EAAG,CAClCV,EAAaE,EACbI,EAAOG,KAAKD,EACZ,OAGJR,IAAYC,EAAID,OAIxB,IAAIQ,EAAKE,QAAQ,KAAO,EAAG,CAEvB,GAAIE,GAAYJ,EAAKH,MAAM,KACvBQ,EAAWD,EAAU,GACrBE,EAAcF,EAAU,EAC5B,IAAuC,IAAnCE,EAAYH,MAAM,MAAMJ,OAAc,CAEtC,IADAP,EAAa,EACRE,EAAID,EAAI,EAAGC,EAAIC,EAAYI,OAAQL,IAEpC,GADAY,GAAe,IAAMX,EAAYD,GAC7BC,EAAYD,GAAGQ,QAAQ,MAAQ,EAAG,CAClCV,EAAaE,CACb,OAGJF,IAAYC,EAAID,GAExB,GAAIe,IAAQF,EAAUC,EAAYV,QAAQ,KAAK,IAC/CE,GAAOG,KAAKM,OAIZT,GAAOG,KAAKD,GAK5B,MAAOF,GAEX,QAASU,GAAejB,GACpB,GAAiBE,GAAGC,EAAhBe,IACJ,KAAKlB,EAAQ,QACb,IAAImB,GAAUnB,EAAOM,MAAM,gBAC3B,KAAKJ,EAAI,EAAGA,EAAIiB,EAAQX,OAAQN,IAAK,CACjC,GAAIkB,GAAQD,EAAQjB,EACpB,IAAc,KAAVkB,EACJ,GAAIA,EAAMT,QAAQ,MAAQ,EACtBO,EAAOR,MACHW,KAAM,QACNC,QAASF,QAGZ,CACD,GAAIA,EAAMT,QAAQ,OAAS,EACvB,QAEJ,IAAIS,EAAMT,QAAQ,MAAQ,GAAKS,EAAMT,QAAQ,KAAO,GAAKS,EAAMT,QAAQ,QAAU,EAAG,CAEhFO,EAAOR,MACHW,KAAM,WACNE,YAAaH,EAAMf,QAAQ,QAAS,KAExC,UAGJ,GAAImB,GAAezB,EAAeqB,GAC9BK,EAAaD,EAAa,GAC1BE,EAA2B,MAAfD,EACZE,KACAC,IACJ,KAAKzB,EAAI,EAAGA,EAAIqB,EAAahB,OAAQL,IAAK,CACtC,GAAI0B,GAAQL,EAAarB,EACrBZ,GAAQsC,GAERD,EAAWC,EAAM,IAAmB,UAAbA,EAAM,IAAiB,EAAQA,EAAM,GAG5DF,EAAcjB,KAAKmB,GAI3B,GAAIT,EAAMT,QAAQ,OAAS,EAAG,CAE1B,GAIIV,GAHA6B,EAAgB,GAChBC,EAAc,GACdC,EAAS,EAETC,GAAc,EAAOC,GAAY,EAAgCC,EAAQ,CAC7E,KAAKhC,EAAID,EAAI,EAAGC,EAAIgB,EAAQX,OAAQL,IAOhC,GANIgB,EAAQhB,GAAGQ,QAAQ,QAAU,GAC7BwB,IAEAhB,EAAQhB,GAAGQ,QAAQ,QAAU,GAC7BwB,IAEAhB,EAAQhB,GAAGQ,QAAQ,MAAQc,IAAe,EAC1CK,GAAiBX,EAAQhB,GACrB+B,IAAWH,GAAeZ,EAAQhB,IACtC6B,QAEC,IAAIb,EAAQhB,GAAGQ,QAAQ,MAAQc,IAAe,EAAG,CAClD,KAAIO,EAAS,GAKR,CACD/B,EAAaE,EACb8B,GAAc,CACd,OAPAD,IACAF,GAAiBX,EAAQhB,GACrB+B,IAAWH,GAAeZ,EAAQhB,QAQrCgB,GAAQhB,GAAGQ,QAAQ,SAAW,GAAe,IAAVwB,EACxCD,GAAY,GAGPA,IAAWJ,GAAiBX,EAAQhB,IACrC+B,IAAWH,GAAeZ,EAAQhB,IAI1C8B,KACIhC,IAAYC,EAAID,GACpBiB,EAAOR,MACHW,KAAM,SACNI,WAAYA,EACZF,YAAaI,EACbL,QAASQ,EACTM,eAAgBL,EAChBf,KAAMY,SAITR,GAAMT,QAAQ,KAAO,IACtBe,IACAD,EAAa,WACTE,EAAc,KAAIA,EAAc,GAAK,IAAMA,EAAc,GAAGtB,QAAQ,OAAQ,IAAM,MAE1Fa,EAAOR,MACHW,KAAM,SACNI,WAAYA,EACZF,YAAaI,EACbX,KAAMY,MAKtB,MAAOV,GAvKX,GAyKI5B,GAAY,SAAU+C,GAItB,QAASC,GAAalB,EAAOe,GACzB,MAAIf,GAAME,QAAgBiB,EAAQnB,EAAME,QAASa,GACrC,WAAa,MAAO,IAEpC,QAASK,GAAkBpB,EAAOe,GAC9B,MAAIf,GAAMgB,eAAuBG,EAAQnB,EAAMgB,eAAgBD,GACnD,WAAa,MAAO,IAEpC,QAASM,GAAcC,EAAMC,GACzB,GAAIC,GAAUC,EAAOC,EAAW,CAChC,IAA4B,IAAxBJ,EAAK/B,QAAQ,OAAc,CAC3BmC,EAAWJ,EAAKpC,MAAM,OAAOE,OAAS,CACtC,IAAIuC,GAAWJ,EAAIrC,MAAM,KAAK,GAAKwC,CACnCH,GAAM,QAAUI,GAAY,EAAIA,EAAW,GAC3CF,EAAQH,EAAKpC,MAAM,OAAOwC,GAAUxC,MAAM,SAET,KAA5BoC,EAAK/B,QAAQ,YAClBgC,EAAM,mBACNE,EAAQH,EAAKpC,MAAM,YAAY,GAAGA,MAAM,MAET,IAA1BoC,EAAK/B,QAAQ,UAClBgC,EAAM,OACNE,EAAQH,EAAKpC,MAAM,UAAU,GAAGA,MAAM,MAGtCuC,EAAQH,EAAKpC,MAAM,IAEvBsC,GAAWD,CACX,KAAK,GAAIzC,GAAI,EAAGA,EAAI2C,EAAMrC,OAAQN,IAAK,CACnC,GAAIO,GAAOoC,EAAM3C,EACS,KAAtBO,EAAKE,QAAQ,KACTT,EAAI,EACJ0C,GAAY,kBAAoBnC,EAAKJ,QAAQ,IAAK,IAAM,KAGxDuC,EAAW,iBAAmBF,EAAKrC,QAAQ,IAAK,IAAM,IAItD2C,SAASvC,GACTmC,GAAY,IAAMnC,EAAO,IAGI,IAAzBA,EAAKE,QAAQ,QACbiC,EAAWnC,EAAKJ,QAAQ,OAAQsC,GAGhCC,GAAY,IAAMnC,EAMlC,MAAOmC,GAEX,QAASK,GAAqBC,EAAcP,GAExC,IAAK,GADDnD,MACKU,EAAI,EAAGA,EAAIgD,EAAa1C,OAAQN,IACA,IAAjCgD,EAAahD,GAAGS,QAAQ,KAAYnB,EAAIkB,KAAKwC,EAAahD,IAE1DV,EAAIkB,KAAK+B,EAAcS,EAAahD,GAAIyC,GAIhD,OAAOnD,GAAI2D,KAAK,MAEpB,QAASZ,GAAQF,EAAUF,GAGvB,GAFAA,EAAQA,GAAS,EACjBE,EAAWA,GAAYe,EAAEf,SACD,gBAAbA,GACP,KAAM,IAAIgB,OAAM,uCAEpB,IAAInC,GAASD,EAAeoB,EAC5B,IAAsB,IAAlBnB,EAAOV,OACP,MAAO,YAAc,MAAO,GAEhC,IAAImC,GAAM,OAASR,EACfmB,EAAe,EAEfA,IADU,IAAVnB,EACgB,cAAgBQ,EAAM,oBAGtB,cAAgBA,EAAM,cAE5B,IAAVR,IACAmB,GAAgB,6FAChBA,GAAgB,oEAChBA,GAAgB,2JAChBA,GAAgB,iCAEpBA,GAAgB,eAChB,IAAIpD,EACJ,KAAKA,EAAI,EAAGA,EAAIgB,EAAOV,OAAQN,IAAK,CAChC,GAAIkB,GAAQF,EAAOhB,EAEnB,IAAmB,UAAfkB,EAAMC,KAAV,CAIA,GAAIuB,GAAUW,CAOd,IALmB,aAAfnC,EAAMC,OACNuB,EAAWH,EAAcrB,EAAMG,YAAaoB,GAC5CW,GAAgB,UAAYV,EAAW,KAAOD,EAAM,MAGrC,WAAfvB,EAAMC,KACN,GAAID,EAAMK,aAAc2B,GAAEI,QACtBD,EAAoBN,EAAqB7B,EAAMG,YAAaoB,GAE5DW,GAAgB,2BAA6BlC,EAAMK,WAAa,UAAYkB,EAAM,MAAQY,GAAsBA,EAAoB,MAAQ,SAAWE,KAAKC,UAAUtC,EAAMJ,MAAQ,2BAA6BsB,EAAalB,EAAOe,EAAQ,GAAK,cAAgBK,EAAkBpB,EAAOe,EAAQ,GAAK,sBAGvS,CACD,GAAIf,EAAMG,YAAYf,OAAS,EAC3B,KAAM,IAAI6C,OAAM,+BAAiCjC,EAAMK,WAAa,IAGpEmB,GAAWH,EAAcrB,EAAMK,WAAYkB,GAC3CW,GAAgB,OAASV,EAAW,MACpCU,GAAgB,eAAiBV,EAAW,OAC5CU,GAAgB,sCAAwCX,EAAM,KAAOC,EAAW,WAAaa,KAAKC,UAAUtC,EAAMJ,MAAQ,2BAA6BsB,EAAalB,EAAOe,EAAM,GAAK,cAAgBK,EAAkBpB,EAAOe,EAAM,GAAK,kBAC1OmB,GAAgB,UAChBA,GAAgB,sCAAwCX,EAAM,KAAOC,EAAW,WAAaa,KAAKC,UAAUtC,EAAMJ,MAAQ,2BAA6BsB,EAAalB,EAAOe,EAAM,GAAK,cAAgBK,EAAkBpB,EAAOe,EAAM,GAAK,kBAC1OmB,GAAgB,UA5BxBA,IAAgB,QAAYlC,EAAa,QAAEf,QAAQ,MAAO,OAAOA,QAAQ,MAAO,OAAOA,QAAQ,KAAM,OAAe,KAkC5H,MADAiD,IAAgB,gBACTK,KAAKC,KAAKvE,OAAQiE,GArI7B,GAAIF,GAAIS,IACRT,GAAEf,SAAWA,EAsIbe,EAAEb,QAAU,SAAUF,GAIlB,MAHKe,GAAEU,WACHV,EAAEU,SAAWvB,EAAQF,IAElBe,EAAEU,UAGjBxE,GAAUI,WACNqE,WACAC,YACAR,SACIS,SAAa,SAAUC,EAAaH,GAChC,GAAII,GAAI7E,EAAUI,UAAUsE,SAASE,EACrC,KAAKC,GAAMA,IAAMA,EAAE9B,SAAW,MAAO,EAChC8B,GAAEL,WACHK,EAAEL,SAAWM,EAAG7B,QAAQ4B,EAAE9B,UAE9B,IAAIM,GAAMkB,IACV,KAAK,GAAI/C,KAAYiD,GAAQ/C,KACzB2B,EAAI7B,GAAYiD,EAAQ/C,KAAKF,EAEjC,OAAOqD,GAAEL,SAASnB,EAAKoB,EAAQM,KAAMN,EAAQO,OAEjDC,OAAU,SAAUC,EAAST,GACzB,GAAuB,gBAAZS,GACP,KAAM,IAAInB,OAAM,kEAEpB,OAAOmB,GACEnE,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,WAE3BoE,KAAM,SAAUD,EAAST,GAErB,MADIlE,GAAW2E,KAAYA,EAAUA,EAAQZ,KAAKC,OAC9CW,EACOT,EAAQW,GAAGb,KAAME,EAAQM,MAGzBN,EAAQY,QAAQd,KAAME,EAAQM,OAG7CO,OAAU,SAAUJ,EAAST,GAEzB,MADIlE,GAAW2E,KAAYA,EAAUA,EAAQZ,KAAKC,OAC7CW,EAIMT,EAAQY,QAAQd,KAAME,EAAQM,MAH9BN,EAAQW,GAAGb,KAAME,EAAQM,OAMxCQ,KAAQ,SAAUL,EAAST,GACvB,GAAIe,GAAM,GAAI5E,EAAI,CAElB,IADIL,EAAW2E,KAAYA,EAAUA,EAAQZ,KAAKC,OAC9CtE,EAAQiF,GAAU,CAIlB,IAHIT,EAAQ/C,KAAK+D,UACbP,EAAUA,EAAQO,WAEjB7E,EAAI,EAAGA,EAAIsE,EAAQhE,OAAQN,IAC5B4E,GAAOf,EAAQW,GAAGF,EAAQtE,IAAK8E,MAAa,IAAN9E,EAAS+E,KAAM/E,IAAMsE,EAAQhE,OAAS,EAAG0E,MAAOhF,GAEtF6D,GAAQ/C,KAAK+D,UACbP,EAAUA,EAAQO,eAItB,KAAK,GAAII,KAAOX,GACZtE,IACA4E,GAAOf,EAAQW,GAAGF,EAAQW,IAAOA,IAAKA,GAG9C,OAAIjF,GAAI,EAAU4E,EACNf,EAAQY,QAAQd,OAEhCuB,OAAQ,SAAUZ,EAAST,GAEvB,MADIlE,GAAW2E,KAAYA,EAAUA,EAAQZ,KAAKC,OAC3CE,EAAQW,GAAGF,IAEtBrB,KAAQ,SAAUqB,EAAST,GAEvB,MADIlE,GAAW2E,KAAYA,EAAUA,EAAQZ,KAAKC,OAC3CW,EAAQrB,KAAKY,EAAQ/C,KAAKqE,WAAatB,EAAQ/C,KAAKsE,YAE/DC,GAAM,SAAUC,EAAYzB,GACxB,GAAIjE,EAOJ,OALIA,GADA0F,EAAW7E,QAAQ,WAAW,EACvB,eAAe6E,EAAW,KAG1B,uBAAuBA,EAAW,MAEtC7B,KAAKC,KAAKC,KAAM/D,GAAM8D,KAAKC,OAEtC4B,WAAc,SAAUD,EAAYzB,GAChC,GAAIjE,EAEAA,GADA0F,EAAW7E,QAAQ,WAAW,EACvB,eAAe6E,EAAW,KAG1B,uBAAuBA,EAAW,KAE7C,IAAIE,GAAY/B,KAAKC,KAAKC,KAAM/D,GAAM8D,KAAKC,KAC3C,OAAI6B,GACO3B,EAAQW,GAAGb,KAAME,EAAQM,MAGzBN,EAAQY,QAAQd,KAAME,EAAQM,QAKrD,IAAID,GAAK,SAAU/B,EAAUgC,GACzB,GAAyB,IAArBsB,UAAUnF,OAAc,CACxB,GAAIoF,GAAW,GAAItG,GAAU+C,GACzBwD,EAAWD,EAASrD,UAAU8B,EAElC,OADAuB,GAAW,KACJ,EAEN,MAAO,IAAItG,GAAU+C,GA2B9B,OAzBA+B,GAAG0B,eAAiB,SAAUpD,EAAMgC,GAChCpF,EAAUI,UAAU8D,QAAQd,GAAQgC,GAExCN,EAAG2B,iBAAmB,SAAUrD,GAC5BpD,EAAUI,UAAU8D,QAAQd,GAAQsD,aAC7B1G,GAAUI,UAAU8D,QAAQd,IAEvC0B,EAAG6B,gBAAkB,SAAUvD,EAAML,GACjC/C,EAAUI,UAAUsE,SAAStB,IAASL,SAAUA,IAEpD+B,EAAG8B,kBAAoB,SAAUxD,EAAML,GAC/B/C,EAAUI,UAAUsE,SAAStB,KAC7BpD,EAAUI,UAAUsE,SAAStB,GAAQsD,aAC9B1G,GAAUI,UAAUsE,SAAStB,KAI5C0B,EAAG7B,QAAU,SAAUF,EAAU0B,GAC7B,GAAI6B,GAAW,GAAItG,GAAU+C,EAAU0B,EACvC,OAAO6B,GAASrD,WAGpB6B,EAAGL,QAAUzE,EAAUI,UAAUqE,QACjCK,EAAGZ,QAAUlE,EAAUI,UAAU8D,QACjCY,EAAGJ,SAAW1E,EAAUI,UAAUsE,SAC3BI","file":"template7.min.js","sourcesContent":["/**\n * Template7 1.1.0\n * Mobile-first JavaScript template engine\n * \n * http://www.idangero.us/template7/\n * \n * Copyright 2015, Vladimir Kharlampidi\n * The iDangero.us\n * http://www.idangero.us/\n * \n * Licensed under MIT\n * \n * Released on: October 3, 2015\n */\nwindow.Template7 = (function () {\n    'use strict';\n    function isArray(arr) {\n        return Object.prototype.toString.apply(arr) === '[object Array]';\n    }\n    function isObject(obj) {\n        return obj instanceof Object;\n    }\n    function isFunction(func) {\n        return typeof func === 'function';\n    }\n    var cache = {};\n    function helperToSlices(string) {\n        var helperParts = string.replace(/[{}#}]/g, '').split(' ');\n        var slices = [];\n        var shiftIndex, i, j;\n        for (i = 0; i < helperParts.length; i++) {\n            var part = helperParts[i];\n            if (i === 0) slices.push(part);\n            else {\n                if (part.indexOf('\"') === 0) {\n                    // Plain String\n                    if (part.match(/\"/g).length === 2) {\n                        // One word string\n                        slices.push(part);\n                    }\n                    else {\n                        // Find closed Index\n                        shiftIndex = 0;\n                        for (j = i + 1; j < helperParts.length; j++) {\n                            part += ' ' + helperParts[j];\n                            if (helperParts[j].indexOf('\"') >= 0) {\n                                shiftIndex = j;\n                                slices.push(part);\n                                break;\n                            }\n                        }\n                        if (shiftIndex) i = shiftIndex;\n                    }\n                }\n                else {\n                    if (part.indexOf('=') > 0) {\n                        // Hash\n                        var hashParts = part.split('=');\n                        var hashName = hashParts[0];\n                        var hashContent = hashParts[1];\n                        if (hashContent.match(/\"/g).length !== 2) {\n                            shiftIndex = 0;\n                            for (j = i + 1; j < helperParts.length; j++) {\n                                hashContent += ' ' + helperParts[j];\n                                if (helperParts[j].indexOf('\"') >= 0) {\n                                    shiftIndex = j;\n                                    break;\n                                }\n                            }\n                            if (shiftIndex) i = shiftIndex;\n                        }\n                        var hash = [hashName, hashContent.replace(/\"/g,'')];\n                        slices.push(hash);\n                    }\n                    else {\n                        // Plain variable\n                        slices.push(part);\n                    }\n                }\n            }\n        }\n        return slices;\n    }\n    function stringToBlocks(string) {\n        var blocks = [], i, j, k;\n        if (!string) return [];\n        var _blocks = string.split(/({{[^{^}]*}})/);\n        for (i = 0; i < _blocks.length; i++) {\n            var block = _blocks[i];\n            if (block === '') continue;\n            if (block.indexOf('{{') < 0) {\n                blocks.push({\n                    type: 'plain',\n                    content: block\n                });\n            }\n            else {\n                if (block.indexOf('{/') >= 0) {\n                    continue;\n                }\n                if (block.indexOf('{#') < 0 && block.indexOf(' ') < 0 && block.indexOf('else') < 0) {\n                    // Simple variable\n                    blocks.push({\n                        type: 'variable',\n                        contextName: block.replace(/[{}]/g, '')\n                    });\n                    continue;\n                }\n                // Helpers\n                var helperSlices = helperToSlices(block);\n                var helperName = helperSlices[0];\n                var isPartial = helperName === '>';\n                var helperContext = [];\n                var helperHash = {};\n                for (j = 1; j < helperSlices.length; j++) {\n                    var slice = helperSlices[j];\n                    if (isArray(slice)) {\n                        // Hash\n                        helperHash[slice[0]] = slice[1] === 'false' ? false : slice[1];\n                    }\n                    else {\n                        helperContext.push(slice);\n                    }\n                }\n                \n                if (block.indexOf('{#') >= 0) {\n                    // Condition/Helper\n                    var helperStartIndex = i;\n                    var helperContent = '';\n                    var elseContent = '';\n                    var toSkip = 0;\n                    var shiftIndex;\n                    var foundClosed = false, foundElse = false, foundClosedElse = false, depth = 0;\n                    for (j = i + 1; j < _blocks.length; j++) {\n                        if (_blocks[j].indexOf('{{#') >= 0) {\n                            depth ++;\n                        }\n                        if (_blocks[j].indexOf('{{/') >= 0) {\n                            depth --;\n                        }\n                        if (_blocks[j].indexOf('{{#' + helperName) >= 0) {\n                            helperContent += _blocks[j];\n                            if (foundElse) elseContent += _blocks[j];\n                            toSkip ++;\n                        }\n                        else if (_blocks[j].indexOf('{{/' + helperName) >= 0) {\n                            if (toSkip > 0) {\n                                toSkip--;\n                                helperContent += _blocks[j];\n                                if (foundElse) elseContent += _blocks[j];\n                            }\n                            else {\n                                shiftIndex = j;\n                                foundClosed = true;\n                                break;\n                            }\n                        }\n                        else if (_blocks[j].indexOf('else') >= 0 && depth === 0) {\n                            foundElse = true;\n                        }\n                        else {\n                            if (!foundElse) helperContent += _blocks[j];\n                            if (foundElse) elseContent += _blocks[j];\n                        }\n\n                    }\n                    if (foundClosed) {\n                        if (shiftIndex) i = shiftIndex;\n                        blocks.push({\n                            type: 'helper',\n                            helperName: helperName,\n                            contextName: helperContext,\n                            content: helperContent,\n                            inverseContent: elseContent,\n                            hash: helperHash\n                        });\n                    }\n                }\n                else if (block.indexOf(' ') > 0) {\n                    if (isPartial) {\n                        helperName = '_partial';\n                        if (helperContext[0]) helperContext[0] = '\"' + helperContext[0].replace(/\"|'/g, '') + '\"';\n                    }\n                    blocks.push({\n                        type: 'helper',\n                        helperName: helperName,\n                        contextName: helperContext,\n                        hash: helperHash\n                    });\n                }\n            }\n        }\n        return blocks;\n    }\n    var Template7 = function (template) {\n        var t = this;\n        t.template = template;\n        \n        function getCompileFn(block, depth) {\n            if (block.content) return compile(block.content, depth);\n            else return function () {return ''; };\n        }\n        function getCompileInverse(block, depth) {\n            if (block.inverseContent) return compile(block.inverseContent, depth);\n            else return function () {return ''; };\n        }\n        function getCompileVar(name, ctx) {\n            var variable, parts, levelsUp = 0, initialCtx = ctx;\n            if (name.indexOf('../') === 0) {\n                levelsUp = name.split('../').length - 1;\n                var newDepth = ctx.split('_')[1] - levelsUp;\n                ctx = 'ctx_' + (newDepth >= 1 ? newDepth : 1);\n                parts = name.split('../')[levelsUp].split('.');\n            }\n            else if (name.indexOf('@global') === 0) {\n                ctx = 'Template7.global';\n                parts = name.split('@global.')[1].split('.');\n            }\n            else if (name.indexOf('@root') === 0) {\n                ctx = 'root';\n                parts = name.split('@root.')[1].split('.');\n            }\n            else {\n                parts = name.split('.');\n            }\n            variable = ctx;\n            for (var i = 0; i < parts.length; i++) {\n                var part = parts[i];\n                if (part.indexOf('@') === 0) {\n                    if (i > 0) {\n                        variable += '[(data && data.' + part.replace('@', '') + ')]';\n                    }\n                    else {\n                        variable = '(data && data.' + name.replace('@', '') + ')';\n                    }\n                }\n                else {\n                    if (isFinite(part)) {\n                        variable += '[' + part + ']';\n                    }\n                    else {\n                        if (part.indexOf('this') === 0) {\n                            variable = part.replace('this', ctx);\n                        }\n                        else {\n                            variable += '.' + part;       \n                        }\n                    }\n                }\n            }\n\n            return variable;\n        }\n        function getCompiledArguments(contextArray, ctx) {\n            var arr = [];\n            for (var i = 0; i < contextArray.length; i++) {\n                if (contextArray[i].indexOf('\"') === 0) arr.push(contextArray[i]);\n                else {\n                    arr.push(getCompileVar(contextArray[i], ctx));\n                }\n            }\n\n            return arr.join(', ');\n        }\n        function compile(template, depth) {\n            depth = depth || 1;\n            template = template || t.template;\n            if (typeof template !== 'string') {\n                throw new Error('Template7: Template must be a string');\n            }\n            var blocks = stringToBlocks(template);\n            if (blocks.length === 0) {\n                return function () { return ''; };\n            }\n            var ctx = 'ctx_' + depth;\n            var resultString = '';\n            if (depth === 1) {\n                resultString += '(function (' + ctx + ', data, root) {\\n';\n            }\n            else {\n                resultString += '(function (' + ctx + ', data) {\\n';\n            }\n            if (depth === 1) {\n                resultString += 'function isArray(arr){return Object.prototype.toString.apply(arr) === \\'[object Array]\\';}\\n';\n                resultString += 'function isFunction(func){return (typeof func === \\'function\\');}\\n';\n                resultString += 'function c(val, ctx) {if (typeof val !== \"undefined\" && val !== null) {if (isFunction(val)) {return val.call(ctx);} else return val;} else return \"\";}\\n';\n                resultString += 'root = root || ctx_1 || {};\\n';\n            }\n            resultString += 'var r = \\'\\';\\n';\n            var i, j, context;\n            for (i = 0; i < blocks.length; i++) {\n                var block = blocks[i];\n                // Plain block\n                if (block.type === 'plain') {\n                    resultString += 'r +=\\'' + (block.content).replace(/\\r/g, '\\\\r').replace(/\\n/g, '\\\\n').replace(/'/g, '\\\\' + '\\'') + '\\';';\n                    continue;\n                }\n                var variable, compiledArguments;\n                // Variable block\n                if (block.type === 'variable') {\n                    variable = getCompileVar(block.contextName, ctx);\n                    resultString += 'r += c(' + variable + ', ' + ctx + ');';\n                }\n                // Helpers block\n                if (block.type === 'helper') {\n                    if (block.helperName in t.helpers) {\n                        compiledArguments = getCompiledArguments(block.contextName, ctx);\n                        \n                        resultString += 'r += (Template7.helpers.' + block.helperName + ').call(' + ctx + ', ' + (compiledArguments && (compiledArguments + ', ')) +'{hash:' + JSON.stringify(block.hash) + ', data: data || {}, fn: ' + getCompileFn(block, depth + 1) + ', inverse: ' + getCompileInverse(block, depth + 1) + ', root: root});';\n                        \n                    }\n                    else {\n                        if (block.contextName.length > 0) {\n                            throw new Error('Template7: Missing helper: \"' + block.helperName + '\"');\n                        }\n                        else {\n                            variable = getCompileVar(block.helperName, ctx);\n                            resultString += 'if (' + variable + ') {';\n                            resultString += 'if (isArray(' + variable + ')) {';\n                            resultString += 'r += (Template7.helpers.each).call(' + ctx + ', ' + variable + ', {hash:' + JSON.stringify(block.hash) + ', data: data || {}, fn: ' + getCompileFn(block, depth+1) + ', inverse: ' + getCompileInverse(block, depth+1) + ', root: root});';\n                            resultString += '}else {';\n                            resultString += 'r += (Template7.helpers.with).call(' + ctx + ', ' + variable + ', {hash:' + JSON.stringify(block.hash) + ', data: data || {}, fn: ' + getCompileFn(block, depth+1) + ', inverse: ' + getCompileInverse(block, depth+1) + ', root: root});';\n                            resultString += '}}';\n                        }\n                    }\n                }\n            }\n            resultString += '\\nreturn r;})';\n            return eval.call(window, resultString);\n        }\n        t.compile = function (template) {\n            if (!t.compiled) {\n                t.compiled = compile(template);\n            }\n            return t.compiled;\n        };\n    };\n    Template7.prototype = {\n        options: {},\n        partials: {},\n        helpers: {\n            '_partial' : function (partialName, options) {\n                var p = Template7.prototype.partials[partialName];\n                if (!p || (p && !p.template)) return '';\n                if (!p.compiled) {\n                    p.compiled = t7.compile(p.template);\n                }\n                var ctx = this;\n                for (var hashName in options.hash) {\n                    ctx[hashName] = options.hash[hashName];\n                }\n                return p.compiled(ctx, options.data, options.root);\n            },\n            'escape': function (context, options) {\n                if (typeof context !== 'string') {\n                    throw new Error('Template7: Passed context to \"escape\" helper should be a string');\n                }\n                return context\n                        .replace(/&/g, '&amp;')\n                        .replace(/</g, '&lt;')\n                        .replace(/>/g, '&gt;')\n                        .replace(/\"/g, '&quot;');\n            },\n            'if': function (context, options) {\n                if (isFunction(context)) { context = context.call(this); }\n                if (context) {\n                    return options.fn(this, options.data);\n                }\n                else {\n                    return options.inverse(this, options.data);\n                }\n            },\n            'unless': function (context, options) {\n                if (isFunction(context)) { context = context.call(this); }\n                if (!context) {\n                    return options.fn(this, options.data);\n                }\n                else {\n                    return options.inverse(this, options.data);\n                }\n            },\n            'each': function (context, options) {\n                var ret = '', i = 0;\n                if (isFunction(context)) { context = context.call(this); }\n                if (isArray(context)) {\n                    if (options.hash.reverse) {\n                        context = context.reverse();\n                    }\n                    for (i = 0; i < context.length; i++) {\n                        ret += options.fn(context[i], {first: i === 0, last: i === context.length - 1, index: i});\n                    }\n                    if (options.hash.reverse) {\n                        context = context.reverse();\n                    }\n                }\n                else {\n                    for (var key in context) {\n                        i++;\n                        ret += options.fn(context[key], {key: key});\n                    }\n                }\n                if (i > 0) return ret;\n                else return options.inverse(this);\n            },\n            'with': function (context, options) {\n                if (isFunction(context)) { context = context.call(this); }\n                return options.fn(context);\n            },\n            'join': function (context, options) {\n                if (isFunction(context)) { context = context.call(this); }\n                return context.join(options.hash.delimiter || options.hash.delimeter);\n            },\n            'js': function (expression, options) {\n                var func;\n                if (expression.indexOf('return')>=0) {\n                    func = '(function(){'+expression+'})';\n                }\n                else {\n                    func = '(function(){return ('+expression+')})';\n                }\n                return eval.call(this, func).call(this);\n            },\n            'js_compare': function (expression, options) {\n                var func;\n                if (expression.indexOf('return')>=0) {\n                    func = '(function(){'+expression+'})';\n                }\n                else {\n                    func = '(function(){return ('+expression+')})';\n                }\n                var condition = eval.call(this, func).call(this);\n                if (condition) {\n                    return options.fn(this, options.data);\n                }\n                else {\n                    return options.inverse(this, options.data);   \n                }\n            }\n        }\n    };\n    var t7 = function (template, data) {\n        if (arguments.length === 2) {\n            var instance = new Template7(template);\n            var rendered = instance.compile()(data);\n            instance = null;\n            return (rendered);\n        }\n        else return new Template7(template);\n    };\n    t7.registerHelper = function (name, fn) {\n        Template7.prototype.helpers[name] = fn;\n    };\n    t7.unregisterHelper = function (name) {\n        Template7.prototype.helpers[name] = undefined;  \n        delete Template7.prototype.helpers[name];\n    };\n    t7.registerPartial = function (name, template) {\n        Template7.prototype.partials[name] = {template: template};\n    };\n    t7.unregisterPartial = function (name, template) {\n        if (Template7.prototype.partials[name]) {\n            Template7.prototype.partials[name] = undefined;\n            delete Template7.prototype.partials[name];\n        }\n    };\n    \n    t7.compile = function (template, options) {\n        var instance = new Template7(template, options);\n        return instance.compile();\n    };\n    \n    t7.options = Template7.prototype.options;\n    t7.helpers = Template7.prototype.helpers;\n    t7.partials = Template7.prototype.partials;\n    return t7;\n})();\n//# sourceMappingURL=template7.js.map\n"],"sourceRoot":"/source/"}